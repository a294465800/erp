"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};$(document).ready(function(){function e(){var e=$(this).val(),i=$(this).parents(".win-item").find(".ho_span");e?i.text(e):i.text("单位")}function i(e){return function(){var i=$(this).parents(e),a=$(this).parents(".data-dom"),n=a.data("name");d(n=n.replace(/index/i,a.data("index")),void 0),i.fadeOut(300,"swing",function(){i.remove()})}}function a(e){e.on("blur",function(){var e=$(this);(function(){var e=this.attr("name"),i=this.val(),a=/(index)/;if(a.test(e)){var n=this.parents(".data-dom").data("index");e=e.replace(a,n)}d(e,i)}).call(e)})}_helper.setActiveNav("#navProject",".list"),laydate.render({elem:"#createDate",done:function(e,i){d("signDate",e)}}),laydate.render({elem:"#completeDate",done:function(e,i){d("completeDate",e)}}),laydate.render({elem:"#margins0",done:function(e,i){d("margins[0].date",e)}});var n={data:_database.read("projects")};function d(e,i){_database.setValue("projects",e,i),console.log(n.data)}var t=$("#winBid");$(".win-company").on("blur",e),$("#addNewBid").on("click",function(){var i=_database.create("projects","masterCompany"),n=$('<div class="win-item data-dom" data-id='+i.id+' data-index="'+i.index+'" data-name="masterCompany[index]"></div>');n.html('\n        <div class="inline fields">\n          <div class="eight wide field fields">\n            <label class="five wide field">单位名称</label>\n            <input name="masterCompany[index].name" type="text" placeholder="请输入单位名称" class="win-company">\n          </div>\n          <div class="eight wide field fields">\n            <label class="five wide field">金额</label>\n            <div class="ui right labeled input">\n              <input name="masterCompany[index].amount" type="number" placeholder="请输入金额">\n              <div class="ui basic label">￥</div>\n            </div>\n          </div>\n        </div>\n        <div class="inline fields">\n          <div class="eight wide field fields">\n            <label class="five wide field">备注</label>\n            <textarea name="masterCompany[index].remark" rows="2" placeholder="请输入备注"></textarea>\n          </div>\n          <div class="eight wide field fields relative">\n            <div class="win-remove-btn ui button red">\n              <i class="icon remove"></i>\n              <span>删除该项</span>\n            </div>\n          </div>\n        </div>\n        <h4 class="ui horizontal divider header">\n          <i class="icon travel"></i>\n          <span class="ho_span">单位</span>\n        </h4>'),n.find(".win-company").on("blur",e),a(n.find("input")),a(n.find("textarea")),n.css("opacity",0),n.insertBefore($(this).parent()),n.animate({opacity:1},500)}),t.on("click",".win-remove-btn",i(".win-item"));var l=$("#divideBid");$("#addNewDivideBid").on("click",function(){var i=_database.create("projects","subCompany"),n=$('<div class="win-item data-dom" data-id='+i.id+' data-index="'+i.index+'" data-name="subCompany[index]"></div>');n.html('\n        <div class="inline fields">\n          <div class="eight wide field fields">\n            <label class="five wide field">发包单位</label>\n            <input name="subCompany[index].name" type="text" placeholder="请输入发包单位" class="win-company">\n          </div>\n          <div class="eight wide field fields">\n            <label class="five wide field">分包金额</label>\n            <div class="ui right labeled input">\n              <input name="subCompany[index].amount" type="number" placeholder="请输入分包金额">\n              <div class="ui basic label">￥</div>\n            </div>\n          </div>\n        </div>\n        <div class="inline fields">\n          <div class="eight wide field fields">\n            <label class="five wide field">备注</label>\n            <textarea name="subCompany[index].remark" rows="2" placeholder="请输入备注"></textarea>\n          </div>\n          <div class="eight wide field fields relative">\n            <div class="win-remove-btn ui button red">\n              <i class="icon remove"></i>\n              <span>删除该项</span>\n            </div>\n          </div>\n        </div>\n        <h4 class="ui horizontal divider header">\n          <i class="icon travel"></i>\n          <span class="ho_span">单位</span>\n        </h4>'),n.find(".win-company").on("blur",e),a(n.find("input")),a(n.find("textarea")),n.css("opacity",0),n.insertBefore($(this).parent()),n.animate({opacity:1},500)}),l.on("click",".win-remove-btn",i(".win-item"));var s=$("#detailItem");$("#addBidNewItem").on("click",function(){var e=_database.create("projects","masterContract.details"),i=$('<div class="field detail-item data-dom"  data-id='+e.id+' data-index="'+e.index+'" data-name="masterContract.details[index]"></div>');i.html('\n        <div class="three fields">\n          <div class="field">\n            <label>内容名称</label>\n            <input type="text" name="masterContract.details[index].name" placeholder="请输入内容名称">\n          </div>\n          <div class="field">\n            <label>税率</label>\n            <div class="ui right labeled input">\n              <input type="number" name="masterContract.details[index].tax" placeholder="税率">\n              <div class="ui basic label">%</div>\n            </div>\n          </div>\n          <div class="field">\n            <label>金额</label>\n            <div class="ui right labeled input">\n              <input type="number" name="masterContract.details[index].amount" placeholder="金额">\n              <div class="ui basic label">￥</div>\n            </div>\n          </div>\n        </div>\n        <div class="two fields">\n          <div class="field">\n            <label>备注</label>\n            <textarea name="masterContract.details[index].remark" rows="2" placeholder="请输入备注"></textarea>\n          </div>\n          <div class="field relative">\n            <label class="invisible">按钮</label>\n            <div class=" ui button red project-item-del">\n              <i class="icon remove"></i>\n              <span>删除该项</span>\n            </div>\n          </div>\n        </div>'),a(i.find("input")),a(i.find("textarea")),i.css("opacity",0),i.insertBefore($(this).parent()),i.animate({opacity:1},500)}),$("#addBidBackNewItem").on("click",function(){var e=_database.create("projects","masterContractAppend.details"),i=$('<div class="field detail-item data-dom" data-id='+e.id+' data-index="'+e.index+'" data-name="masterContractAppend.details[index]"></div>');i.html('\n        <div class="three fields">\n          <div class="field">\n            <label>内容名称</label>\n            <input type="text" name="masterContractAppend.details[index].name" placeholder="请输入内容名称">\n          </div>\n          <div class="field">\n            <label>税率</label>\n            <div class="ui right labeled input">\n              <input type="number" name="masterContractAppend.details[index].tax" placeholder="税率">\n              <div class="ui basic label">%</div>\n            </div>\n          </div>\n          <div class="field">\n            <label>金额</label>\n            <div class="ui right labeled input">\n              <input type="number" name="masterContractAppend.details[index].amount" placeholder="金额">\n              <div class="ui basic label">￥</div>\n            </div>\n          </div>\n        </div>\n        <div class="two fields">\n          <div class="field">\n            <label>备注</label>\n            <textarea name="masterContractAppend.details[index].remark" rows="2" placeholder="请输入备注"></textarea>\n          </div>\n          <div class="field relative">\n            <label class="invisible">按钮</label>\n            <div class=" ui button red project-item-del">\n              <i class="icon remove"></i>\n              <span>删除该项</span>\n            </div>\n          </div>\n        </div>'),a(i.find("input")),a(i.find("textarea")),i.css("opacity",0),i.insertBefore($(this).parent()),i.animate({opacity:1},500)}),s.on("click",".project-item-del",i(".detail-item")),$("#addBidDivideNewItem").on("click",function(){var e=_database.create("projects","subContract.details"),i=$('<div class="field detail-item data-dom" data-id='+e.id+' data-index="'+e.index+'" data-name="subContract.details[index]"></div>');i.html('\n        <div class="three fields">\n          <div class="field">\n            <label>内容名称</label>\n            <input type="text" name="subContract.details[index].name" placeholder="请输入内容名称">\n          </div>\n          <div class="field">\n            <label>税率</label>\n            <div class="ui right labeled input">\n              <input type="number" name="subContract.details[index].tax" placeholder="税率">\n              <div class="ui basic label">%</div>\n            </div>\n          </div>\n          <div class="field">\n            <label>金额</label>\n            <div class="ui right labeled input">\n              <input type="number" name="subContract.details[index].amount" placeholder="金额">\n              <div class="ui basic label">￥</div>\n            </div>\n          </div>\n        </div>\n        <div class="two fields">\n          <div class="field">\n            <label>备注</label>\n            <textarea name="subContract.details[index].remark" rows="2" placeholder="请输入备注"></textarea>\n          </div>\n          <div class="field relative">\n            <label class="invisible">按钮</label>\n            <div class=" ui button red project-item-del">\n              <i class="icon remove"></i>\n              <span>删除该项</span>\n            </div>\n          </div>\n        </div>'),a(i.find("input")),a(i.find("textarea")),i.css("opacity",0),i.insertBefore($(this).parent()),i.animate({opacity:1},500)}),$("#addBidDivideBackNewItem").on("click",function(){var e=_database.create("projects","subContractAppend.details"),i=$('<div class="field detail-item data-dom" data-id='+e.id+' data-index="'+e.index+'" data-name="subContractAppend.details[index]"></div>');i.html('\n        <div class="three fields">\n          <div class="field">\n            <label>内容名称</label>\n            <input type="text" name="subContractAppend.details[index].name" placeholder="请输入内容名称">\n          </div>\n          <div class="field">\n            <label>税率</label>\n            <div class="ui right labeled input">\n              <input type="number" name="subContractAppend.details[index].tax" placeholder="税率">\n              <div class="ui basic label">%</div>\n            </div>\n          </div>\n          <div class="field">\n            <label>金额</label>\n            <div class="ui right labeled input">\n              <input type="number" name="subContractAppend.details[index].amount" placeholder="金额">\n              <div class="ui basic label">￥</div>\n            </div>\n          </div>\n        </div>\n        <div class="two fields">\n          <div class="field">\n            <label>备注</label>\n            <textarea name="subContractAppend.details[index].remark" rows="2" placeholder="请输入备注"></textarea>\n          </div>\n          <div class="field relative">\n            <label class="invisible">按钮</label>\n            <div class=" ui button red project-item-del">\n              <i class="icon remove"></i>\n              <span>删除该项</span>\n            </div>\n          </div>\n        </div>'),a(i.find("input")),a(i.find("textarea")),i.css("opacity",0),i.insertBefore($(this).parent()),i.animate({opacity:1},500)}),$("#addMarginItem").on("click",function(){var e=_database.create("projects","margins"),i=$('<div class="field data-dom" data-id='+e.id+" data-index="+e.index+' data-name="margins[index]"></div>'),n='\n        <div class="three fields">\n          <div class="field">\n            <label>支付日期</label>\n            <input type="text" id="margins'+e.index+'" name="margins[index].date" placeholder="请选择日期">\n          </div>\n          <div class="field">\n            <label>支付金额</label>\n            <div class="ui right labeled input">\n              <input type="number" name="margins[index].amount" placeholder="金额">\n              <div class="ui basic label">￥</div>\n            </div>\n          </div>\n          <div class="field">\n            <label>收款人</label>\n            <input type="text" name="margins[index].payee" placeholder="请输入收款人">\n          </div>\n        </div>\n        <div class="two fields">\n          <div class="field">\n            <label>回收条件</label>\n            <textarea name="margins[index].recycle" rows="2" placeholder="请输入回收条件"></textarea>\n          </div>\n          <div class="field relative">\n            <label class="invisible">按钮</label>\n            <div class=" ui button red project-item-del">\n              <i class="icon remove"></i>\n              <span>删除该项</span>\n            </div>\n          </div>\n        </div>\n        <h4 class="ui horizontal divider header">\n          <i class="icon remove bookmark"></i>\n        </h4>';i.html(n),a(i.find("input")),a(i.find("textarea")),i.css("opacity",0),i.insertBefore($(this).parent()),laydate.render({elem:"#margins"+e.index,done:function(i,a){d("margins["+e.index+"].date",i)}}),i.animate({opacity:1},500)}),$("#marginsItem").on("click",".project-item-del",i(".data-dom")),$("#addConditionItem").on("click",function(){var e=_database.create("projects","paymentConditions"),i=$('<div class="field data-dom" data-id='+e.id+" data-index="+e.index+' data-name="paymentConditions[index]"></div>');i.html('\n        <div class="two fields">\n          <div class="field">\n            <label>收款比例</label>\n            <div class="ui right labeled input">\n              <input type="number" name="paymentConditions[index].rate" placeholder="请输入收款比例">\n              <div class="ui basic label">%</div>\n            </div>\n          </div>\n          <div class="field">\n            <label>预计金额</label>\n            <div class="ui right labeled input">\n              <input type="number" name="paymentConditions[index].expected" placeholder="请输入预计金额">\n              <div class="ui basic label">￥</div>\n            </div>\n          </div>\n        </div>\n        <div class="two fields">\n          <div class="field">\n            <label>收款条件</label>\n            <textarea name="paymentConditions[index].condition" rows="2" placeholder="请输入收款条件"></textarea>\n          </div>\n          <div class="field relative">\n            <label class="invisible">按钮</label>\n            <div class=" ui button red project-item-del">\n              <i class="icon remove"></i>\n              <span>删除该项</span>\n            </div>\n          </div>\n        </div>\n        <h4 class="ui horizontal divider header ">\n          <i class="icon remove bookmark"></i>\n        </h4>'),a(i.find("input")),a(i.find("textarea")),i.css("opacity",0),i.insertBefore($(this).parent()),i.animate({opacity:1},500)}),$("#paymentConditionItem").on("click",".project-item-del",i(".data-dom"));var c=$("#contractUpload"),r=$("#contarctFiles");c.on("change",function(){var e=$(this)[0].files[0];if(void 0!==(void 0===e?"undefined":_typeof(e))){(new FormData).append("image",e);var i=$("<img>");i.attr("src",window.URL.createObjectURL(e)),r.append(i)}}),a($("input")),a($("textarea"))});